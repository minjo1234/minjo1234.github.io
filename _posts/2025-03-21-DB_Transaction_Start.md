---
title: DB 트랜잭션(Transaction)
author: minjo
date: 2025-04-21 10:00:00 +08
categories: [DB, Transaction]
tags: [DB, Transaction, ACID]
math: true
toc: true
pin: true
mermaid: true
---

# 트랜잭션의 개요

---

서비스 운영하면서 DB 성능 저하 이슈가 발생하면, 특정 쿼리만 골라서 성능을 개선하였다.
하지만 이러한 경우 다수의 쿼리가 동시에 실행되거나, 중간에 실패하였을 때 데이터가 꼬이는 현상이 발생하면서 **성능 최적화 뿐만 아니라 트랜잭션 자체의 이해가 더 중요한 문제**임을 깨달았다.

이 글을 통해 트랜잭션의 개념을 깊이있게 이해하고자 한다.

---

흔히 DB를 사용한다면 트랜잭션과 트랜잭션의 특징(ACID)를 간단하게 알고있겠지만
깊이 있게 트랜잭션을 이해하고 쿼리를 작성하지는 않는다고 생각한다.

트랜잭션을 깊이 있게 이해하면 <font color="#ff0000">동시성 제어, 트랜잭션 분산 처리, 성능 최적화, 고립성 수준(Isolation Level)</font> 등을 보다 정확히 다룰 수 있다. 이 글에서는 개발자 관점에서 이러한 이론을 실습과 함께 확인하고자 한다. (기본적으로 DDL, DML, DCL 명령어에 대한 이해를 전제로 한다.)

---

### 트랜잭션

트랜잭션 → DB의 상태를 변경시키는 작업의 단위
한 번에 수행되어야 할 연산들을 하나의 단위로 묶는다.

모든 연산이 성공해야만 변경 사항이 확정된다.  
만약 하나라도 실패하면, 전체 작업은 원래 상태로 복구(rollback)된다.  
이렇게 트랜잭션은 작업의 **완전성(Atomicity)** 을 보장한다.

---

### 2. 조회 쿼리(SELECT)도 하나의 트랜잭션인가?

보통 `SELECT`는 단순히 데이터를 조회하는 쿼리이기 때문에 트랜잭션과는 무관하다고 생각하기 쉽다.

하지만 대부분의 DBMS는 `SELECT`도 하나의 **읽기 전용 트랜잭션 (Read-Only Transaction)**으로 처리한다.

즉, 아래와 같은 쿼리를 실행했을 때도

````sql
#### user 테이블을 조회하는 경우

```sql
SELECT * FROM user;
````

내부적으로는 다음과 같이 트랜잭션이 시작되고 자동으로 종료된다:

```sql
BEGIN;
SELECT * FROM user;
COMMIT;
```

이처럼 트랜잭션은 **데이터를 바꾸는 작업뿐 아니라 조회하는 작업에도 적용**된다는 점을 기억해야 한다.

---

### 3. 트랜잭션 요약

✅ **트랜잭션 정리 요약**

| 명령어 유형                  | 트랜잭션 처리 방식                                                                     |
| ---------------------------- | -------------------------------------------------------------------------------------- |
| `COMMIT`, `ROLLBACK`         | 수동 트랜잭션 종료를 위한 명령어                                                       |
| `SELECT`                     | 대부분의 DB에서 자동 커밋 (Auto Commit) → 내부적으로 트랜잭션 수행                     |
| `INSERT`, `UPDATE`, `DELETE` | Auto Commit 모드에서는 자동 종료<br>수동 모드에서는 명시적인 COMMIT 또는 ROLLBACK 필요 |

※ 🙋‍♂️ 요약: 데이터베이스는 조회/수정/삭제 모두 트랜잭션 안에서 처리되며, 명시적이든 암묵적이든 트랜잭션 경계가 항상 존재한다.
